# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要
**GBAゲーム「遊☆戯☆王デュエルモンスターズ エキスパート2006」専用のカード検索ツール**  
HTML/CSS/JavaScript（静的サイト）で作成されたWebアプリケーション  
ゲーム攻略のためにGoogle Spreadsheetで管理していた約2,000件のカードデータをCSVで読み込み、高速検索を実現

### ゲーム背景
- **対象ゲーム**: 遊☆戯☆王デュエルモンスターズ エキスパート2006（GBA、2006年発売）
- **目的**: ゲーム内でのデッキ構築・カード収集の効率化
- **データ範囲**: ゲームに収録されたカードのみを対象（約2,000枚）

### 技術スタック
- **フロントエンド**: HTML5, CSS3, vanilla JavaScript (ES6+)
- **データ形式**: CSV files
- **データ処理**: JavaScript (CSVパーサー)
- **検索機能**: リアルタイム検索、フィルタリング

## 開発・実行方法
- **開発環境**: Live Server拡張機能を使用してindex.htmlを開く
- **テスト**: ブラウザで動作確認（コンソールで「データ読み込み完了」メッセージを確認）
- **デバッグ**: ブラウザの開発者ツール（F12）でコンソールエラーを確認
- **スマホ確認**: MacのIPアドレス:5500でアクセス（同一Wi-Fi必須）

## アーキテクチャ
### ファイル構成
```
yugioh-card-search/
├── data/
│   ├── card_master.csv    # ゲーム収録カードの基本情報（ID、種類、名前、パック情報）
│   ├── pack_master.csv    # ゲーム内パック情報（ID、パック名、出現内容）
│   └── query_results.csv  # 検索結果用（元SQLシート）
├── index.html             # メインページ
├── style.css             # スタイル
├── script.js             # 検索ロジック
├── javascript-learning-guide.md # script.js専用学習教材
├── README.md             # セットアップ手順、使用方法
└── CLAUDE.md             # このファイル
```

### データ構造
#### card_master.csv
```
#,種,カード名,パック
0001,1,13人目の埋葬者,"01,20,31,46"
0002,1,アクア・マドール,"01,29,46"
```
- **A列**: カードID（0001~）
- **B列**: 種類（1=通常モンスター、2=効果モンスター、3=融合モンスター、4=魔法、5=罠）
- **C列**: カード名
- **D列**: パック情報（カンマ区切り）

#### pack_master.csv
```
#,パック名,出現内容,手に入れやすさ
01,LEGEND OF BLUE EYES WHITE DRAGON,最初から出現,1
02,METAL RAIDERS,最初から出現,1
```
- **A列**: パックID（01~）
- **B列**: パック名
- **C列**: 出現内容
- **D列**: 手に入れやすさ

### 検索システム
アプリは元のGoogle Spreadsheet QUERY関数を完全再現：
```
=QUERY(card!A:D,"select * where B matches '"&JOIN("|",2,3,4,5)&"' and D contains '"&TO_TEXT(B2)&"' order by B,A")
```

3つの主要なフィルタリング機能：
1. **パック選択**: pack_master.csvからプルダウン生成、選択されたパックIDでカードをフィルタリング
2. **種類フィルター**: 5つのチェックボックス（通常モンスター、効果モンスター、融合モンスター、魔法、罠）
3. **カード名検索**: リアルタイム部分一致検索

### CSVパーサー
カスタムCSVパーサーがダブルクォートで囲まれたデータを処理：
- `parseCSV()`: card_master.csv用
- `parsePackCSV()`: pack_master.csv用
- `parseCSVLine()`: ダブルクォート考慮の行パーサー

### データフロー
1. `loadData()`: 初期化時に両CSVファイルを読み込み
2. `performSearch()`: フィルター条件に基づいて検索実行
3. `displayResults()`: デスクトップ用テーブルとモバイル用カード表示の両方を更新
4. `showReverseLookup()`: カード名クリック時の逆引き機能

### レスポンシブ対応
- **768px以上**: テーブル表示（.desktop-only）
- **768px未満**: カード型表示（.mobile-only）
- CSS Grid で自動レイアウト調整

## 重要な実装詳細
### 種類マッピング
```javascript
1: '通常モンスター'
2: '効果モンスター'
3: '融合モンスター'
4: '魔法'
5: '罠'
```

### パックIDの処理
- CSVデータ内のパック情報は「"01,20,31,46"」形式
- 検索時は2桁ゼロパディング（`padStart(2, '0')`）で比較

### 逆引き機能
カード名をクリックすると、そのカードが収録されているパック一覧を表示するモーダルが開く

## データ更新方法
静的サイトのため、データ更新は手動でCSVファイルを置き換え。data/フォルダ内の該当ファイルを更新後、ブラウザリロードで反映。

## 学習目標と技術的工夫
### 学習目標
- CSV データの JavaScript での処理方法
- リアルタイム検索の実装
- 配列操作とフィルタリング
- DOM操作による動的UI更新
- 複数データソースの連携処理
- ゲーム攻略ツールとしての実用性向上

### 技術的な工夫点
- データ全体をメモリに読み込み、高速検索を実現
- 正規表現を使った柔軟な検索
- 元のGoogle Spreadsheet QUERY関数の動作を完全再現
- パフォーマンスを考慮したデータ構造設計
- ゲーム攻略に特化したUI/UX設計

## 今後の開発方針
### 短期計画（完了済み）
- ✅ GitHubリポジトリの作成とアップロード
- ✅ README.md作成（セットアップ手順含む）
- ✅ データ更新手順の文書化

### 中期計画（技術学習）- 次の目標
- **React + Tailwind CSS への移行** 🎯 メイン目標
- Fuse.js導入による高度な検索機能
- TypeScript導入による型安全性向上
- PWA対応（オフライン利用）

### 長期計画（機能拡張）
- カード詳細情報の追加（攻撃力・守備力・効果）
- デッキ管理機能（お気に入り・構築）
- 遊戯王公式API連携
- ユーザー機能（設定・履歴）

## 開発時の注意事項
- このプロジェクトは学習目的かつゲーム攻略支援ツール
- 現在は静的サイト（HTML/CSS/JavaScript）として完成済み
- データ更新はCSVファイルの手動置換
- 静的サイトのため、データ更新は手動でCSVファイルを置き換え
- ブラウザの互換性に配慮（ES6+対応ブラウザ）
- 約2,000件のゲームデータを一度に処理するため、メモリ使用量に注意
- このツールはゲーム「遊☆戯☆王デュエルモンスターズ エキスパート2006」専用
- expense-trackerプロジェクトは現在メンテナンス対象外

## 学習ガイド修正方針
### 基本方針
- script.jsで実際に使用されている機能のみに焦点を当てる
- 一般的なJavaScriptリファレンスではなく、このプロジェクト専用の学習教材として位置づけ
- 詳細な説明よりも実用性を重視し、簡潔で理解しやすい内容にする

### 対象読者
- 中級者の入り口レベル（jQuery経験あり、DOM操作基礎は理解済み）
- 包括的な解説よりも、実際のコードとの関連性を重視

### 記載内容の基準
1. **必須項目**: script.jsで実際に使用されているメソッド・プロパティのみ
2. **詳細情報**: 引数・戻り値・注意点を簡潔に記載
3. **実例**: このプロジェクトでの実際の使用例を優先
4. **相互参照**: 関連する機能間の関係性を明示

### 除外する内容
- script.jsで未使用のメソッド・プロパティ
- 過度に詳細な解説や多数の例
- 初心者向けの基礎概念説明
- jQuery との比較

## ファイル役割分担
- **CLAUDE.md**: 開発手順、技術情報、プロジェクト情報、Claude Code向けガイド
- **README.md**: セットアップ手順、使用方法、一般向け情報
- **javascript-learning-guide.md**: script.js専用学習教材